# 02. ES6ì—ì„œì˜ ìˆœíšŒì™€ ì´í„°ëŸ¬ë¸” ì´í„°ë ˆì´í„° í”„ë¡œí† ì½œ

## 1. ê¸°ì¡´ê³¼ ë‹¬ë¼ì§„ ES6ì—ì„œì˜ ë¦¬ìŠ¤íŠ¸ ìˆœíšŒ

1. ê¸°ì¡´ ES6 ì´ì „ì˜ ë¦¬ìŠ¤íŠ¸ ìˆœíšŒ ğŸ’©
   - for i++
   - ìˆœíšŒë¥¼ êµ¬ì²´ì /ëª…ë ¹ì ìœ¼ë¡œ ê¸°ìˆ í•¨

```js
// ê¸°ì¡´ ES6 ì´ì „ì˜ ë¦¬ìŠ¤íŠ¸ ìˆœíšŒ
const list = [1, 2, 3];
for (var i = 0; i < list.length; i++) {
  log(list[i]); // ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ìš”ì†Œì— ì ‘ê·¼
}

const str = "abc";
for (var i = 0; i < str.length; i++) {
  log(str[i]);
}
```

2. ES6 ì´í›„ì˜ ë¦¬ìŠ¤íŠ¸ ìˆœíšŒ âœ¨
   - for of
   - ìˆœíšŒë¥¼ ì„ ì–¸ì ìœ¼ë¡œ ê¸°ìˆ í•¨
   - ê°„ê²°í•´ì§

```js
// ES6 ì´í›„ì˜ ë¦¬ìŠ¤íŠ¸ ìˆœíšŒ
const list = [1, 2, 3];
for (const a of list) {
  log(a); // for...of ë£¨í”„ë¥¼ ì‚¬ìš©í•˜ì—¬ ìš”ì†Œì— ì ‘ê·¼
}

const str = "abc";
for (const a of str) {
  log(a);
}
```

ğŸ‘‰ ë³µì¡í•œ forë¬¸ì„ ì¡°ê¸ˆ ê°„ê²°í•˜ê²Œ ë§Œë“  ê²ƒ ì´ìƒì˜ ì˜ë¯¸ê°€ ìˆëŠ”ë°, ES6ê°€ ìˆœíšŒì— ëŒ€í•´ì„œ ì¶”ìƒí™”ë¥¼ í–ˆëŠ”ì§€ ì•Œì•„ë³´ì!

---

Array, Map, Setì€ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë‚´ì¥ê°ì²´ë¡œì„œ, ì´í„°ëŸ¬ë¸”/ì´í„°ë ˆì´í„° í”„ë¡œí† ì½œì„ ë”°ë¥´ê³  ìˆë‹¤.

### 1-1. Arrayë¥¼ í†µí•´ ì•Œì•„ë³´ê¸°

```js
const arr = [1, 2, 3];
let iter = arr[Symbol.iterator](); // Array IteratorÂ {}
iter.next(); // {value: 1, done: false}
iter.next(); // {value: 2, done: false}

// ì´ ì‹œì ì—ì„œ iterëŠ” ì´ë¯¸ ë‘ ìš”ì†Œë¥¼ ìˆœíšŒ
for (const a of iter) log(a); // 3ë§Œ ì¶œë ¥ë¨
iter.next(); // {value: undefined, done: true}
```

- `arr[Symbol.iterator]()`ë¥¼ í•˜ë©´ ì´í„°ë ˆì´í„°ê°€ ë°˜í™˜ëœë‹¤.
- ë°˜í™˜ëœ ì´í„°ë ˆì´í„°ì—ì„œ `next()`í•˜ë©´ ê·¸ ë‹¤ìŒ ìˆœì„œë¶€í„° ìˆœíšŒí•œë‹¤.

```js
const arr = [1, 2, 3];
let iter = arr[Symbol.iterator];
iter = null; // ì´í„°ë ˆì´í„° ì‚­ì œ
for (const a of arr) log(a); // â—ï¸ Uncaught TypeError: arr is not iterable
```

- iteratorë¥¼ ì‚­ì œí•˜ë©´ ìˆœíšŒê°€ ì •ìƒì ìœ¼ë¡œ ë˜ì§€ ì•Šê³  ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤

### 1-2. Setì„ í†µí•´ ì•Œì•„ë³´ê¸°

```js
const set = new Set([1, 2, 3]);
set[0]; // undefined

let iter = set[Symbol.iterator](); // SetIteratorÂ {1, 2, 3}
iter.next(); // {value: 1, done: false}
iter.next(); // {value: 2, done: false}
iter.next(); // {value: 3, done: false}
iter.next(); // {value: undefined, done: true}
for (const a of set) log(a);
```

- arrayì™€ëŠ” ë‚´ë¶€êµ¬í˜„ì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì—`set[0]`, `set[1]`ë¡œ ì ‘ê·¼í•  ìˆ˜ ì—†ë‹¤ (ì¸ë±ì‹± X)
- í•˜ì§€ë§Œ ë‚´ë¶€ì ìœ¼ë¡œ iteratorì„ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— for of ë¥¼ í†µí•´ ìˆœíšŒí•  ìˆ˜ ìˆë‹¤.

### 1-3. Mapì„ í†µí•´ ì•Œì•„ë³´ê¸°

```js
const map = new Map([
  ["a", 1],
  ["b", 2],
  ["c", 3],
]);

// ì•„ë˜ ë©”ì†Œë“œë“¤ì€ ëª¨ë‘ ì´í„°ë ˆì´í„°ë¥¼ ë°˜í™˜í•œë‹¤.
map.keys(); // MapIterator {'a', 'b', 'c'}
map.values(); // MapIterator {1, 2, 3}
map.entries(); // MapIterator {'a' => 1, 'b' => 2, 'c' => 3}

// ë”°ë¼ì„œ ì•„ë˜ì™€ ê°™ì´ for ...ofë¬¸ìœ¼ë¡œ ìˆœíšŒí•  ìˆ˜ ìˆë‹¤.
for (const a of map.keys()) log(a);
for (const a of map.values()) log(a);
for (const a of map.entries()) log(a);

let iter = map.values(); // map.values()ë¥¼ í˜¸ì¶œí•˜ë©´ ì´í„°ë ˆì´í„°ê°€ ë°˜í™˜ë¨
let iter2 = iter[Symbol.iterator](); // ì´í„°ë ˆì´í„° ìì²´ë¥¼ ë°˜í™˜
console.log(iter2.next()); // {value: 1, done: false}
```

---

## 2. ì´í„°ëŸ¬ë¸”/ì´í„°ë ˆì´í„° í”„ë¡œí† ì½œ

- **ì´í„°ëŸ¬ë¸”:** ì´í„°ë ˆì´í„°ë¥¼ ë¦¬í„´í•˜ëŠ” `[Symbol.iterator]()` ë¥¼ ê°€ì§„ ê°’
- **ì´í„°ë ˆì´í„°:** `{ value, done }` ê°ì²´ë¥¼ ë¦¬í„´í•˜ëŠ” `next()` ë¥¼ ê°€ì§„ ê°’
- **ì´í„°ëŸ¬ë¸”/ì´í„°ë ˆì´í„° í”„ë¡œí† ì½œ**: ì´í„°ëŸ¬ë¸”ì„ `for...of`, `ì „ê°œ ì—°ì‚°ì` ë“±ê³¼ í•¨ê»˜ ë™ì‘í•˜ë„ë¡í•œ ê·œì•½

### ì‚¬ìš©ì ì •ì˜ ì´í„°ëŸ¬ë¸”ì„ í†µí•´ ì•Œì•„ë³´ê¸°

#### 1) ì•„ì§ ë¶ˆì™„ì „í•œ ì‚¬ìš©ì ì •ì˜ ì´í„°ë ˆì´í„°

```js
const iterable = {
  [Symbol.iterator]() {
    let i = 3;
    return {
      next() {
        return i == 0 ? { done: true } : { value: i--, done: false };
      },
    };
  },
};

let iterator = iterable[Symbol.iterator]();

// ì´í„°ë ˆì´í„°ì˜ next ë©”ì†Œë“œë¥¼ í†µí•´ ë‚´ë¶€ ê°’ì„ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
// iterator.next(); // {value: 3, done: false}
// iterator.next(); // {value: 2, done: false}
// iterator.next(); // {value: 1, done: false}
// iterator.next(); // {done: true}

// ë”°ë¼ì„œ iterableì„ ìˆœíšŒí•  ìˆ˜ ìˆë‹¤.
for (const a of iterable) log(a);

// í•˜ì§€ë§Œ ì•„ì§ iterator ìì²´ë¡œëŠ” ìˆœíšŒí•  ìˆ˜ ì—†ë‹¤. ğŸ’©
for (const a of iterator) log(a); // â—ï¸ Uncaught TypeError: iterator is not iterable
```

#### 2) ì™„ë²½í•œ ì´í„°ë ˆì´í„°ê°€ ë˜ë ¤ë©´?

```js
const arr2 = [1, 2, 3];
let iter2 = arr2[Symbol.iterator]();

iter2.next(); // ì¼ë¶€ ì§„í–‰í•œ ìƒíƒœì—ì„œ,
for (const a of iter2) log(a); // ë‚˜ë¨¸ì§€ ê°’ë“¤ë¡œ ìˆœíšŒë¥¼ í•  ìˆ˜ ìˆë‹¤.

// ìê¸° ìì‹ ì„ ë°˜í™˜í•˜ëŠ” Symbol.iteratorë¥¼ ê°€ì§€ê³  ìˆë‹¤.
log(iter2[Symbol.iterator]() == iter2); // true
```

- ì´í„°ë ˆì´í„°ëŠ” for...ofì— ì§ì ‘ ë„£ì—ˆì„ ë•Œ ëª¨ë“  ê°’ë“¤ì„ ìˆœíšŒí•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.
- ì´í„°ë ˆì´í„°ëŠ” ì¤‘ê°„ë¶€í„° ìˆœíšŒë¥¼ ì‹œì‘í•  ìˆ˜ë„ ìˆì–´ì•¼ í•œë‹¤.
- ë”°ë¼ì„œ ì´í„°ë ˆì´í„°ëŠ” ìê¸° ìì‹ ì„ ë°˜í™˜í•˜ëŠ” Symbol.iteratorë¥¼ ê°€ì§€ê³  ìˆì–´ì•¼ í•œë‹¤.

#### 3) ì™„ì„±ëœ ì‚¬ìš©ì ì •ì˜ ì´í„°ë ˆì´í„° (well-formed iterator)

```js
const iterable = {
  [Symbol.iterator]() {
    let i = 3;
    return {
      next() {
        return i == 0 ? { done: true } : { value: i--, done: false };
      },
      [Symbol.iterator]() {
        return this;
      },
    };
  },
};

let iterator = iterable[Symbol.iterator]();
iterator.next(); // {value: 3, done: false}
iterator.next(); // {value: 2, done: false}
for (const a of iterator) log(a); // 1ë§Œ ì¶œë ¥ë¨
```

#### êµ¬í˜„ ì‚¬ë¡€

ë¸Œë¼ìš°ì €ì˜ ì›¹ APIë‚˜ ë§ì€ ì˜¤í”ˆì†ŒìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œë„ ì´í„°ëŸ¬ë¸”ê³¼ ì´í„°ë ˆì´í„° í”„ë¡œí† ì½œì´ êµ¬í˜„ë˜ì–´ ìˆë‹¤.

```js
for (const a of document.querySelectorAll("*")) log(a);
const all = document.querySelectorAll("*");
let iter3 = all[Symbol.iterator]();
log(iter3.next());
log(iter3.next());
log(iter3.next());
```

ê¸°íƒ€ ë§ì€ ì˜¤í”ˆì†ŒìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ (ex. í˜ì´ìŠ¤ë¶ì—ì„œ ë§Œë“  immutable.js)ë“¤ì´ ì‹¬ë³¼ ì´í„°ë ˆì´í„°ë¡œ êµ¬í˜„ë˜ì–´ ìˆë‹¤.

---

## 3. ì „ê°œ ì—°ì‚°ì

- ì „ê°œ ì—°ì‚°ì(...)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´í„°ëŸ¬ë¸” ê°ì²´ë“¤ì„ ë‹¤ë¥¸ ë°°ì—´ì— í¼ì³ ë„£ì„ ìˆ˜ ìˆë‹¤.
- ì´í„°ëŸ¬ë¸”ì´ ì•„ë‹Œ ê°ì²´ì— ì „ê°œ ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ë ¤ê³  í•˜ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.

```js
const a = [1, 2];
// a[Symbol.iterator] = null;
log([...a, ...arr, ...set, ...map.keys()]);
```
