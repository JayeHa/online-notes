# CHAPTER 06 ê¸°ë³¸ì ì¸ ë¦¬íŒ©í„°ë§

## 6.1 í•¨ìˆ˜ ì¶”ì¶œí•˜ê¸°

[ğŸ“‚ 6-1 ì ìš©ì˜ˆì‹œ](./6-1.js)

```js
export function printOwing(invoice) {
  let outstanding = 0;

  console.log("***********************");
  console.log("**** Customer Owes ****");
  console.log("***********************");

  // calculate outstanding
  for (const o of invoice.orders) {
    outstanding += o.amount;
  }

  // record due date
  const today = new Date();
  invoice.dueDate = new Date(
    today.getFullYear(),
    today.getMonth(),
    today.getDate() + 30
  );

  //print details
  console.log(`name: ${invoice.customer}`);
  console.log(`amount: ${outstanding}`);
  console.log(`due: ${invoice.dueDate.toLocaleDateString()}`);
}

const invoice = {
  orders: [{ amount: 2 }, { amount: 5 }],
  customer: "ì—˜ë¦¬",
};
printOwing(invoice);
```

## 6.2 í•¨ìˆ˜ ì¸ë¼ì¸í•˜ê¸°

[ğŸ“‚ 6-2 ì ìš©ì˜ˆì‹œ](./6-2.js)

```js
// ì˜ˆì œ 1
export function rating(driver) {
  return moreThanFiveLateDeliveries(driver) ? 2 : 1;
}

function moreThanFiveLateDeliveries(dvr) {
  return dvr.numberOfLateDeliveries > 5;
}

// ì˜ˆì œ 2
function reportLines(customer) {
  const lines = [];
  gatherCustomerData(lines, customer);
  return lines;
}

function gatherCustomerData(out, customer) {
  out.push(["name", customer.name]);
  out.push(["location", customer.location]);
}
```

## 6.3 ë³€ìˆ˜ ì¶”ì¶œí•˜ê¸°

[ğŸ“‚ 6-3-1 ì ìš©ì˜ˆì‹œ 1](./6-3-1.js)

```js
// 6-3-1.js
export function price(order) {
  // ê°€ê²©(price) = ê¸°ë³¸ê°€ê²© - ìˆ˜ëŸ‰í• ì¸ + ë°°ì†¡ë¹„
  return (
    order.quantity * order.itemPrice -
    Math.max(0, order.quantity - 500) * order.itemPrice * 0.05 +
    Math.min(order.quantity * order.itemPrice * 0.1, 100)
  );
}
```

[ğŸ“‚ 6-3-2 ì ìš©ì˜ˆì‹œ](./6-3-2.js)

```js
// 6-3-2.js
export class Order {
  constructor(aRecord) {
    this._data = aRecord;
  }

  get quantity() {
    return this._data.quantity;
  }
  get itemPrice() {
    return this._data.itemPrice;
  }

  get price() {
    return (
      this.quantity * this.itemPrice -
      Math.max(0, this.quantity - 500) * this.itemPrice * 0.05 +
      Math.min(this.quantity * this.itemPrice * 0.1, 100)
    );
  }
}
```

## 6.4 ë³€ìˆ˜ ì¸ë¼ì¸í•˜ê¸°

[ğŸ“‚ 6-4 ì ìš©ì˜ˆì‹œ](./6-4.js)

```js
export function isDeliveryFree(anOrder) {
  let basePrice = anOrder.basePrice;
  return basePrice > 1000;
}
```

## 6.5 í•¨ìˆ˜ ì„ ì–¸ ë°”ê¾¸ê¸°

[ğŸ“‚ 6-5-1 ì ìš©ì˜ˆì‹œ](./6-5-1.js)

```js
// 6-5-1.js
export function circum(radius) {
  return 2 * Math.PI * radius;
}
```

[ğŸ“‚ 6-5-2 ì ìš©ì˜ˆì‹œ](./6-5-2.js)

```js
// 6-5-2.js
export default class Book {
  #reservations;
  constructor() {
    this.#reservations = [];
  }

  addReservation(customer) {
    this.#reservations.push(customer);
  }

  hasReservation(customer) {
    return this.#reservations.some(
      (reservedCustomer) => reservedCustomer.id === customer.id
    );
  }
}
```

[ğŸ“‚ 6-5-3 ì ìš©ì˜ˆì‹œ](./6-5-3.js)

```js
// 6-5-3.js
export function inNewEngland(aCustomer) {
  return ["MA", "CT", "ME", "VT", "NH", "RI"].includes(aCustomer.address.state);
}
```

## 6.6 ë³€ìˆ˜ ìº¡ìŠí™”í•˜ê¸°

[ğŸ“‚ 6-6 ì ìš©ì˜ˆì‹œ](./6-6.js)

```js
// 6-6.js
let defaultOwner = { firstName: "ë§ˆí‹´", lastName: "íŒŒìš¸ëŸ¬" };

export function getDefaultOwner() {
  return defaultOwner;
}
```

[ğŸ“‚ 6-6-use ì ìš©ì˜ˆì‹œ](./6-6-use.js)

```js
// 6-6-use.js
import { getDefaultOwner } from "./6-6.js";

const owner = getDefaultOwner();
owner.firstName = "ì—˜ë¦¬";
console.log(owner);
console.log(getDefaultOwner());
```

## 6.7 ë³€ìˆ˜ ì´ë¦„ ë°”ê¾¸ê¸°

[ğŸ“‚ 6-7 ì ìš©ì˜ˆì‹œ](./6-7.js)

```js
let a = height * width;

const cpyNm = "ì• í”Œ";

let tpHd = "ì œëª©ì—†ìŒ";
let result = `<h1>${tpHd}</h1>`;
```

## 6.8 ë§¤ê°œë³€ìˆ˜ ê°ì²´ ë§Œë“¤ê¸°

[ğŸ“‚ 6-8 ì ìš©ì˜ˆì‹œ](./6-8.js)

```js
export function readingsOutsideRange(station, min, max) {
  return station.readings.filter((r) => r.temp < min || r.temp > max);
}

const station = {
  name: "ZB1",
  readings: [
    { temp: 47, time: "2016-11-10 09:10" },
    { temp: 53, time: "2016-11-10 09:20" },
    { temp: 58, time: "2016-11-10 09:30" },
    { temp: 53, time: "2016-11-10 09:40" },
    { temp: 51, time: "2016-11-10 09:50" },
  ],
};
const operationPlan = {
  temperatureFloor: 51,
  temperatureCeiling: 53,
};

readingsOutsideRange(
  station,
  operationPlan.temperatureFloor,
  operationPlan.temperatureCeiling
);
```

## 6.9 ì—¬ëŸ¬ í•¨ìˆ˜ë¥¼ í´ë˜ìŠ¤ë¡œ ë¬¶ê¸°

[ğŸ“‚ 6-9 ì ìš©ì˜ˆì‹œ](./6-9.js)

```js
// 6-9.js
const reading = { customer: "ivan", quantity: 10, month: 5, year: 2017 };

export function acquireReading() {
  return reading;
}

export function baseRate(month, year) {
  if (year === 2017 && month === 5) return 0.1;
  return 0.2;
}
```

[ğŸ“‚ 6-9-client1 ì ìš©ì˜ˆì‹œ](./6-9-client1.js)

```js
// 6-9-client1.js
import { acquireReading, baseRate } from "./6-9.js";

const aReading = acquireReading();

const baseCharge = baseRate(aReading.month, aReading.year) * aReading.quantity;
console.log(baseCharge);
```

[ğŸ“‚ 6-9-client2 ì ìš©ì˜ˆì‹œ](./6-9-client2.js)

```js
// 6-9-client2.js
import { acquireReading, baseRate } from "./6-9.js";

const aReading = acquireReading();
const base = baseRate(aReading.month, aReading.year) * aReading.quantity;

function taxThreshold(year) {
  return 0.1;
}

export const taxableCharge = Math.max(0, base - taxThreshold(aReading.year));
```

[ğŸ“‚ 6-9-client3 ì ìš©ì˜ˆì‹œ](./6-9-client3.js)

```js
// 6-9-client3.js
import { acquireReading, baseRate } from "./6-9.js";

const aReading = acquireReading();

function calculateBaseCharge(aReading) {
  return baseRate(aReading.month, aReading.year) * aReading.quantity;
}

const basicChargeAmount = calculateBaseCharge(aReading);
```

## 6.10 ì—¬ëŸ¬ í•¨ìˆ˜ë¥¼ ë³€í™˜ í•¨ìˆ˜ë¡œ ë¬¶ê¸°

[ğŸ“‚ 6-10 ì ìš©ì˜ˆì‹œ](./6-10.js)

```js
const reading = { customer: "ivan", quantity: 10, month: 5, year: 2017 };

export function acquireReading() {
  return reading;
}

export function baseRate(month, year) {
  if (year === 2017 && month === 5) return 0.1;
  return 0.2;
}
```

[ğŸ“‚ 6-10-client1 ì ìš©ì˜ˆì‹œ](./6-10-client1.js)

```js
// 6-10-client1.js
import { acquireReading, baseRate } from "./6-10.js";

const aReading = acquireReading();

const baseCharge = baseRate(aReading.month, aReading.year) * aReading.quantity;
console.log(baseCharge);
```

## 6.11 ë‹¨ê³„ ìª¼ê°œê¸°

[ğŸ“‚ 6-11 ì ìš©ì˜ˆì‹œ](./6-11.js)

```js
// 6-11.js
export function priceOrder(product, quantity, shippingMethod) {
  const basePrice = product.basePrice * quantity;
  const discount =
    Math.max(quantity - product.discountThreshold, 0) *
    product.basePrice *
    product.discountRate;
  const shippingPerCase =
    basePrice > shippingMethod.discountThreshold
      ? shippingMethod.discountedFee
      : shippingMethod.feePerCase;
  const shippingCost = quantity * shippingPerCase;
  const price = basePrice - discount + shippingCost;
  return price;
}

// ì‚¬ìš© ì˜ˆ:
const product = {
  basePrice: 10,
  discountRate: 0.1,
  discountThreshold: 10,
};

const shippingMethod = {
  discountThreshold: 20,
  feePerCase: 5,
  discountedFee: 3,
};

const price = priceOrder(product, 5, shippingMethod);
console.log(price);
```

[ğŸ“‚ 6-11-2 ì ìš©ì˜ˆì‹œ](./6-11-2.js)

```js
// 6-11-2.js
import fs from "fs";

if (!process.argv[2]) {
  throw new Error("íŒŒì¼ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”");
}

const fileName = `./${process.argv[2]}.json`;
if (!fs.existsSync(fileName)) {
  throw new Error("íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤");
}

const rawData = fs.readFileSync(fileName);
const orders = JSON.parse(rawData);
if (process.argv.includes("-r")) {
  console.log(orders.filter((order) => order.status === "ready").length);
} else {
  console.log(orders.length);
}
```
